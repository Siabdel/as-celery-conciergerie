{% extends "base_service.html" %}
{% load static %}

{% block title %}
    Conciergerie Pro Manager 
{% endblock %}

{% block extra_css %}
    <script> console.log("CSS fullcalendar css !!" ); </script>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
{% endblock %}

{% block extra_test %}
    <h1> Test block </h1>
{% endblock %}


{% block extra_js  %}
    <script> console.log("JS dashboard chargé"); </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/fr.min.js"></script>
{% endblock %}

{% block extra_block_hero %} {% endblock %}

{% block content %}
    <div id="app" class="container mt-4">
        <div class="flex h-screen overflow-hidden">
            <!-- Sidebar -->
            <div class="sidebar bg-indigo-700 text-white w-64 flex-shrink-0 md:block hidden">
                <div class="p-4">
                    <h1 class="text-2xl font-bold flex items-center">
                        <i class="fas fa-concierge-bell mr-2"></i>
                    [[ agency.name ]]
                    </h1>
                    <p class="text-indigo-200 text-sm mt-1">Gestion des réservations </p>
                </div>
                <nav class="mt-6">
                    <div class="px-4">
                        <div class="py-2 text-indigo-200 uppercase text-xs font-semibold">Navigation</div>
                        <a href="#" class="block py-2.5 px-4 rounded-lg bg-indigo-800 text-white font-medium">
                            <i class="fas fa-home mr-2"></i> Tableau de bord
                        </a>
                        <a href="#" class="block py-2.5 px-4 rounded-lg hover:bg-indigo-800 text-indigo-100 font-medium mt-1">
                            <i class="fas fa-calendar-alt mr-2"></i> Réservations
                        </a>
                        <a href="#" class="block py-2.5 px-4 rounded-lg hover:bg-indigo-800 text-indigo-100 font-medium mt-1">
                            <i class="fas fa-building mr-2"></i> Appartements
                        </a>
                        <a href="#" class="block py-2.5 px-4 rounded-lg hover:bg-indigo-800 text-indigo-100 font-medium mt-1">
                            <i class="fas fa-chart-line mr-2"></i> Statistiques
                        </a>
                        <a href="#" class="block py-2.5 px-4 rounded-lg hover:bg-indigo-800 text-indigo-100 font-medium mt-1">
                            <i class="fas fa-cog mr-2"></i> Paramètres
                        </a>
                    </div>
                </nav>
                <div class=" w-full p-4">
                    <div class="bg-indigo-800 rounded-lg p-3">
                        <div class="flex items-center">
                            <img src="https://ui-avatars.com/api/?name=Admin+User&background=6366f1&color=fff" class="w-10 h-10 rounded-full">
                            <div class="ml-3">
                                <p class="text-white font-medium">Admin User</p>
                                <p class="text-indigo-200 text-xs">Administrateur</p>
                            </div>
                        </div>
                        <button class="mt-3 w-full py-1.5 px-3 bg-indigo-600 hover:bg-indigo-500 rounded text-sm">
                            <i class="fas fa-sign-out-alt mr-1"></i> Déconnexion
                        </button>
                    </div>
                </div>
            </div>

            <!-- Main content -->
            <div class="flex-1 overflow-auto">
                <!-- Top bar -->
                <header class="bg-white shadow-sm py-3 px-4 flex items-center justify-between">
                    <div class="flex items-center">
                        <button id="sidebarToggle" class="md:hidden text-gray-600 mr-2">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        <h2 class="text-xl font-semibold text-gray-800">Tableau de bord</h2>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <button class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-bell text-xl"></i>
                                <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">3</span>
                            </button>
                        </div>
                        <div class="relative md:hidden">
                            <img src="https://ui-avatars.com/api/?name=Admin+User&background=6366f1&color=fff" class="w-8 h-8 rounded-full">
                        </div>
                    </div>
                </header>

                <!-- Main content area -->
                <main class="p-4">
                     <!-- 1.  Période & date -->
                    <!-- 1.  Période & date (branchés sur v-model) -->
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label class="form-label">Période :</label>
                            <select class="form-select" v-model="period" @change="loadDashboard">
                            <option value="week">Week</option>
                            <option value="month">Month</option>
                            <option value="quarter">Quarter</option>
                            <option value="year">Year</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Date de référence :</label>
                            <input type="date" class="form-control" v-model="pickedDate" @change="loadDashboard">
                        </div>
                        <div class="col-md-4 d-flex align-items-end">
                            <button class="btn btn-primary" @click="exportExcel">
                            <i class="bi bi-download"></i> Export Excel
                            </button>
                        </div>
                    </div>
                    <!-- Stats cards -->
                      <!-- Cartes récapitulatives -->
                   <div class="col-12 mb-4">
                        <div class="row g-4" id="22">
                        <!-- Cartes injectées via JS -->
                            <div v-for="card in recapCards" :key="card.id" class="col-12 col-sm-6 col-lg-3">
                                    <div class="card dashboard-card">
                                        <div class="card-body text-center">
                                            <i :class="card.class" style="color: #005E9B;"></i>
                                            <h3 class="card-value">[[ card.value ]]</h3>
                                            <p class="card-text text-muted">[[ card.title ]]</p>
                                        </div>
                                    </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="bg-white rounded-lg shadow-sm p-5 card-hover transition-all duration-300">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-500 text-sm">Taux d'Occupation</p>
                                    <h3 class="text-2xl font-bold text-gray-800 mt-1"> [[ occupancyRate ]] %</h3>
                                    <p class="text-green-500 text-sm mt-1">
                                        <i class="fas fa-arrow-up mr-1"></i> 5% vs last month</p>
                                </div>
                                <div class="bg-indigo-100 p-3 rounded-full text-indigo-600">
                                    <i class="fas fa-bed text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm p-5 card-hover transition-all duration-300">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-500 text-sm">Revenue du mois</p>
                                    <h3 class="text-2xl font-bold text-gray-800 mt-1"> € [[ stats.revenue  ]] [[ agency.currency ]]</h3>
                                    <p class="text-green-500 text-sm mt-1"><i class="fas fa-arrow-up mr-1"></i> 12% vs last month</p>
                                </div>
                                <div class="bg-green-100 p-3 rounded-full text-green-600">
                                    <i class="fas fa-euro-sign text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm p-5 card-hover transition-all duration-300">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-500 text-sm"> nombre de réservations en cours </p>
                                    <h3 class="text-2xl font-bold text-gray-800 mt-1"> [[ stats.active_properties]] </h3>
                                    <p class="text-blue-500 text-sm mt-1"><i class="fas fa-exchange-alt mr-1"></i> 3 new today</p>
                                </div>
                                <div class="bg-blue-100 p-3 rounded-full text-blue-600">
                                    <i class="fas fa-calendar-check text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm p-5 card-hover transition-all duration-300">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-500 text-sm"> pourcentage d’appartements disponibles </p>
                                    <h3 class="text-2xl font-bold text-gray-800 mt-1">8/15</h3>
                                    <p class="text-yellow-500 text-sm mt-1"><i class="fas fa-info-circle mr-1"></i> 53% available</p>
                                </div>
                                <div class="bg-yellow-100 p-3 rounded-full text-yellow-600">
                                    <i class="fas fa-building text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Calendar section -->
                        <div class="lg:col-span-2 bg-white rounded-lg shadow-sm p-4">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold text-gray-800">Planning des réservations</h3>
                                <div class="flex space-x-2">
                                    <button class="px-3 py-1 bg-indigo-600 text-white rounded text-sm hover:bg-indigo-700">
                                        <i class="fas fa-plus mr-1"></i> Nouvelle réservation
                                    </button>
                                    <div class="relative">
                                        <select class="appearance-none bg-gray-100 border border-gray-300 rounded px-3 py-1 pr-8 text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500">
                                            <option>Tous les appartements</option>
                                            <option>Appartement 1</option>
                                            <option>Appartement 2</option>
                                            <option>Appartement 3</option>
                                        </select>
                                        <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                            <i class="fas fa-chevron-down text-gray-500 text-xs"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="calendar-container" id="calendar" ref="calendar"></div>
                        </div>

                        <!-- Recent bookings and quick actions -->
                        <div class="space-y-6">
                            <!-- Recent bookings -->
                            <!-- 5.  Dernières réservations (branchées sur Vue.js) -->
                            <div class="row mb-4">
                                <div class="bg-white rounded-lg shadow-sm p-4">
                                    
                                    <h3 class="text-lg font-semibold text-gray-800 mb-3"> Dernière Réservations </h3>
                                    <div class="space-y-3">
                                    <div v-for="resa in latestReservations" :key="resa.id" class="flex items-start p-3 hover:bg-gray-50 rounded-lg transition-colors">
                                        
                                        <div class="bg-indigo-100 p-2 rounded-lg text-indigo-600 mr-3">
                                            <i class="fas fa-calendar-day"></i>
                                        </div>
                                        <div class="flex-1">
                                        <p class="font-medium text-gray-800">[[ resa.property_name ]]</p>
                                        <p class="text-sm text-gray-500">[[ formatDate(resa.check_in) ]] → [[ formatDate(resa.check_out) ]]</p>
                                        <p class="text-xs mt-1">[[ resa.guest_name ]]</p>
                                        </div>
                                        <span :class="statusBadgeClass(resa.status)" class="px-2 py-1 rounded-full text-xs font-medium">
                                        [[ statusLabel(resa.status) ]]
                                        </span>
                                        <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">Confirmé</span>
                                    </div>
                                    <button class="mt-3 w-full py-2 px-3 bg-gray-100 hover:bg-gray-200 rounded text-sm text-gray-600 font-medium">
                                        Voir toutes les réservations
                                    </button>
                                    </div>
                                </div>
                            </div>


                            <!-- Quick actions -->
                            <div class="bg-white rounded-lg shadow-sm p-4">
                                <h3 class="text-lg font-semibold text-gray-800 mb-3">Actions rapides</h3>
                                <div class="grid grid-cols-2 gap-3">
                                    <button class="flex flex-col items-center justify-center p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors">
                                        <div class="bg-indigo-100 p-3 rounded-full text-indigo-600 mb-2">
                                            <i class="fas fa-plus"></i>
                                        </div>
                                        <span class="text-sm font-medium text-gray-700">Nouvelle réservation</span>
                                    </button>
                                    <button class="flex flex-col items-center justify-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors">
                                        <div class="bg-green-100 p-3 rounded-full text-green-600 mb-2">
                                            <i class="fas fa-building"></i>
                                        </div>
                                        <span class="text-sm font-medium text-gray-700">Ajouter appartement</span>
                                    </button>
                                    <button class="flex flex-col items-center justify-center p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors">
                                        <div class="bg-blue-100 p-3 rounded-full text-blue-600 mb-2">
                                            <i class="fas fa-file-invoice-dollar"></i>
                                        </div>
                                        <span class="text-sm font-medium text-gray-700">Générer facture</span>
                                    </button>
                                    <button class="flex flex-col items-center justify-center p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors">
                                        <div class="bg-purple-100 p-3 rounded-full text-purple-600 mb-2">
                                            <i class="fas fa-chart-pie"></i>
                                        </div>
                                        <span class="text-sm font-medium text-gray-700">Voir statistiques</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Apartments list -->
                     <!-- 7.  Liste des appartements (branchée sur les données) -->
                    <div class="row mb-4">
                    <div class="col-12">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-gray-800">Liste des appartements</h3>
                            <button class="px-3 py-1 bg-indigo-600 text-white rounded text-sm hover:bg-indigo-700">
                                <i class="fas fa-plus mr-1"></i> Ajouter
                            </button>
                        </div>
                        <div class="table-responsive">
                        <table class="table table-hover align-middle">
                            <thead class="table-light">
                            <tr>
                                <th>Nom</th>
                                <th>Type</th>
                                <th>Capacité</th>
                                <th>Prix/nuit</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-for="apt in properties" :key="apt.id">
                                <td>
                                <div class="d-flex align-items-center">
                                    <div class="bg-indigo-100 rounded-3 d-flex align-items-center justify-content-center me-3" style="width:40px;height:40px;">
                                    <i class="fas fa-home text-indigo-600"></i>
                                    </div>
                                    <div>
                                    <p class="mb-0 fw-bold">[[ apt.name ]]</p>
                                    <small class="text-muted">[[ apt.address ]]</small>
                                    </div>
                                </div>
                                </td>
                                <td>[[ apt.type ]]</td>
                                <td>[[ apt.capacity ]] pers.</td>
                                <td>[[ apt.price_per_night ]] [[ agency.currency ]]</td>
                                <td>
                                <span :class="statusClass(apt.is_active)" class="px-2 py-1 rounded-pill small">
                                    [[ statusLabel(apt.is_active) ]] [[ apt.is_active ]]
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Disponible</span>
                                        </td>
                                </span>
                                </td>
                                <td>
                                <button class="btn btn-sm btn-outline-primary me-1" @click="editApartment(apt.id)">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger" @click="deleteApartment(apt.id)">
                                    <i class="fas fa-trash"></i>
                                </button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <p v-if="properties.length === 0" class="text-muted">Aucun appartement pour cette agence.</p>
                        </div>
                    </div>
                    </div>
                </main>
            </div>
        </div>
        <style scoped>
            .card { transition: transform .2s; }
            .card:hover { transform: translateY(-3px); }
        </style> 
    </div>
{% endblock content %}


{% block extra_js_plus %}
    <script>
        // ------------------------------------------------------------------
        //  Vue 2  Options API
        // ------------------------------------------------------------------

        const { createApp } = Vue;
        createApp({
            delimiters: ['[[', ']]'],
            data() {
                return {
                    message: "Happy Bee Bonjour !",
                    today: new Date().toLocaleDateString("fr-FR"),
                    period: 'quarter',
                    // pickedDate: new Date().toISOString().slice(0, 10),
                    pickedDate: "2025-09-15",
                    stats: {},
                    agency: {},
                    checkins: [],
                    checkouts: [],
                    services: [],
                    occupancy: [],
                    platformChart: null,
                    occupancyChart: null,
                    occupancyRate: 0,
                    totalProperties: 0,
                    calendar: null,
                    events: [],
                    properties: [],
                    recapCards: [],
                    checkingInsToday : 0,
                    checkOutsToday : 0,
                    servicesToday : 0,
                    //----
                }
            },
            mounted () {
                this.loadDashboard();
                this.loadProperties(); // ← nouvel appel
                this.buildCalendarEvents(); // charge ²vénements   
                this.buildCard(); // charge les cartes récapitulatives 

                this.$nextTick(() => this.initCalendar());
                console.log("last latestReservations =", this.checkins);
            },

            // ------------------------------------------------------------------
            //  Dernières réservations (branchées sur les données)
            // ------------------------------------------------------------------
            computed: {
                latestReservations() {
                    return this.checkins.slice(0, 3);
                }
            },
            methods: {
                //----
                buildCard(){
                    // Injecter les cartes récapitulatives
                    this.recapCards = [{
                            class : "fas fa-building fa-2x mb-2",
                            title: 'Biens actifs',
                            value: 12,
                        },
                        {
                            class : "fas fa-sign-in-alt fa-2x mb-2",
                            title: 'Check-ins à faire',
                            value: this.checkingInsToday
                        },
                        {
                            class: "fas fa-sign-out-alt fa-2x mb-2",
                            title: 'Départs',
                            value: this.checkOutsToday
                        },
                        {
                            icon: 'broom',
                            class: "fas fa-broom fa-2x mb-2",
                            title: 'Services à faire',
                            value: this.servicesToday
                        }
                    ]
                },
                //---------------
                //- buildCalendarEvents
                //---------------
                buildCalendarEvents() {
                    this.events = [
                        ...this.checkins.map(r => ({
                        title: `Check-in ${r.guest_name}`,
                        start: r.check_in,
                        color: '#28a745'
                        })),
                        ...this.checkouts.map(r => ({
                        title: `Check-out ${r.guest_name}`,
                        start: r.check_out,
                        color: '#dc3545'
                        }))
                    ];
                this.initCalendar();
                },
                //--------------
                //- initCalendar
                //--------------
                initCalendar() {
                    //if(!this.$refs.calendar) return;
                    //if (this.calendar) this.calendar.destroy();

                    this.calendar = new FullCalendar.Calendar(this.$refs.calendar, {
                        locale: 'fr',
                        initialView: 'dayGridMonth',
                        initialDate: this.pickedDate,
                        headerToolbar: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'dayGridMonth,timeGridWeek,listWeek',
                        dateAlignment: 'center',
                        },
                        events: this.events, // tableau d’événements (voir plus bas)
                        dateClick: info => {
                        console.log('Date cliquée :', info.dateStr);
                        }
                    });
                    console.log("InitCalendar ..chargé", { ...this.events });
                    // ou 
                    console.log("Events = ", JSON.parse(JSON.stringify(this.events)));
                    this.calendar.render();
                },
                // ------------------------------------------------------------------
                //  Liste des appartements (branchée sur les données)
                // ------------------------------------------------------------------
                async loadProperties() {
                    try {
                        const res = await axios.get("/api/properties/myagency/", {
                        headers: { Authorization: `Bearer ${localStorage.getItem("access") || ""}` }
                    });
                    this.properties = res.data.results || res.data; // compat DRF / liste
                    console.log("Properties loaded", { ...this.properties });
                    } catch (err) {
                        console.error("Properties error", err);
                        this.properties = [];
                    }
                },
                // 7.  Liste des appartements (branchée sur les données)
                latestApartments() {
                    // on prend les 10 premiers (ou tous)
                    console.log("Properties loaded", { ...this.properties.slice(0, 3) });
                    return { ...this.properties.slice(0, 10) };
                },
                statusClass(isActive) {
                    return isActive ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800';
                },
                statusLabel(isActive) {
                    return isActive ? 'Disponible' : 'Hors service';
                },
                editApartment(id) {
                    console.log("Edit apartment", id);
                },
                deleteApartment(id) {
                    console.log("Delete apartment", id);
                },
                //---------------
                //- loadDashboard
                //---------------
                loadDashboard() {
                    const url = `/api/dashboard/${this.period}/?day=2025-09-28`;
                    console.log("url loadDashboard =  ", url);
                    axios.get(url, {
                        params: { day: this.pickedDate },
                        headers: { Authorization: `Bearer ${localStorage.getItem("access") || ""}` }
                        }).then(response => {
                        this.agency = response.data.agency;
                        this.stats = response.data.today_stats;
                        this.checkins = response.data.checkins;
                        this.checkouts = response.data.checkouts;
                        this.services = response.data.services;
                        this.occupancy = response.data.occupancy_last7;
                        //this.occupancy.reduce((sum, o) => sum + Number(o.rate), 0) / this.occupancy.length;  
                        this.occupancyRate = this.occupancy.length ? Math.round(this.occupancy.reduce((sum, o) => sum + Number(o.rate || 0), 0) / this.occupancy.length)
                         : 0;


                        this.totalProperties = this.stats.active_properties || 0;
                        this.drawCharts();
                        this.buildCalendarEvents();
                        //console.log("Dashboard loaded", { ...res.data });
                        // ✅ AFFICHAGE CORRECT
                        // console.log("Agency = ", { ...this.agency });
                        // console.log("Stats = ", { ...this.stats });
                        // this.starts.revenue = this.revenue.toFixed(2); // → "1234.57"
                        // dans votre méthode
                        this.stats.revenue = parseFloat(this.stats.revenue).toFixed(2);

                        }).catch(err => {
                            console.error("Dashboard error", err);
                            alert("Erreur lors du chargement du dashboard");
                        });
                },
                //--------------------------------------------------
                // Charts
                //--------------------------------------------------
                drawCharts() {
                // Platform pie
                    const ctx1 = document.getElementById("platformChart");
                    if (ctx1) {
                        if (this.platformChart) this.platformChart.destroy();
                        this.platformChart = new Chart(ctx1, {
                        type: "doughnut",
                        data: {
                            labels: Object.keys(this.stats.platform_breakdown || {}),
                            datasets: [{
                            data: Object.values(this.stats.platform_breakdown || {}),
                            backgroundColor: ["#FF6B35", "#005E9B", "#FFC107", "#28A745"]
                            }]
                        },
                        options: { plugins: { legend: { position: "bottom" } } }
                        });
                    };

                    // Occupancy line
                    const ctx2 = document.getElementById("occupancyChart");
                    if (ctx2) {
                        if (this.occupancyChart) this.occupancyChart.destroy();
                        this.occupancyChart = new Chart(ctx2, {
                        type: "line",
                        data: {
                            labels: this.occupancy.map(o => o.day),
                            datasets: [{
                            label: "Taux %",
                            data: this.occupancy.map(o => o.rate),
                            borderColor: "#FF6B35",
                            backgroundColor: "rgba(255,107,53,.2)",
                            tension: .3,
                            fill: true
                            }]
                        },
                        options: { plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true, max: 100 } } }
                        });
                    }
                },
                //--------------------
                //--
                //---------------------- 
                exportExcel() {
                    // 1.  Build CSV string
                    let csv = "Day,Rate\n";
                    this.occupancy.forEach(o => csv += `${o.day},${o.rate}\n`);
                    // 2.  Download
                    const blob = new Blob([csv], { type: "text/csv" });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement("a");
                    a.href = url;
                    a.download = `occupancy_${this.period}_${this.pickedDate}.csv`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                },
  
                // ------------------------------------------------------------------
                //   Statut badges
                // ------------------------------------------------------------------
                
                statusIconClass(status) {
                    const map = {
                    'CONFIRMED': 'bg-green-500',
                    'CHECKED_IN': 'bg-blue-500',
                    'CHECKED_OUT': 'bg-purple-500',
                    'COMPLETED': 'bg-gray-500',
                    'PENDING': 'bg-yellow-500',
                    'CANCELLED': 'bg-red-500'
                    };
                    return map[status] || 'bg-gray-500';
                },
                statusBadgeClass(status) {
                    const map = {
                    'CONFIRMED': 'bg-green-100 text-green-800',
                    'CHECKED_IN': 'bg-blue-100 text-blue-800',
                    'CHECKED_OUT': 'bg-purple-100 text-purple-800',
                    'COMPLETED': 'bg-gray-100 text-gray-800',
                    'PENDING': 'bg-yellow-100 text-yellow-800',
                    'CANCELLED': 'bg-red-100 text-red-800'
                    };
                    return map[status] || 'bg-gray-100 text-gray-800';
                },
                statusLabel(status) {
                    const map = {
                    'CONFIRMED': 'Confirmé',
                    'CHECKED_IN': 'Arrivé',
                    'CHECKED_OUT': 'Parti',
                    'COMPLETED': 'Terminé',
                    'PENDING': 'En attente',
                    'CANCELLED': 'Annulé'
                    };
                    return map[status] || status;
                },
                formatDate(dt) {
                    return new Date(dt).toLocaleDateString("fr-FR");
                }
            }
        }).mount('#app');

    </script>

{% endblock extra_js_plus %}

  
